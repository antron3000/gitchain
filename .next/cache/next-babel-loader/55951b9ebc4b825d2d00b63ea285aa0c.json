{"ast":null,"code":"var _jsxFileName = \"/home/hrishib/Desktop/gitchain/pages/users/display/index.js\";\nvar __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from \"react\";\nimport Layout from \"../../../components/Layout\";\nimport projhub from \"../../../ethereum/projhub\";\nimport web3 from \"../../../ethereum/web3\";\nimport ipfs from \"../../../ethereum/ipfs\";\nimport { Grid, Container, Card, Button } from \"semantic-ui-react\";\nimport { Router, Link } from \"../../../routes\";\n\nclass DisplayUser extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      userIndex: 0,\n      userName: \"\",\n      userAddress: \"\",\n      userEmail: \"\",\n      userProjCount: 0,\n      projects: [],\n      projCards: [],\n      loading: false,\n      currUserAdd: \"\",\n      currUserId: \"\",\n      isFollower: true\n    });\n\n    _defineProperty(this, \"onFollow\", async () => {\n      this.setState({\n        loading: true\n      });\n      const userAcc = this.state.userAddress;\n      const currUserAdd = this.state.currUserAdd;\n      const currUserId = this.state.currUserId;\n      console.log(currUserAdd, currUserId);\n\n      try {\n        await projhub.methods.followUser(currUserId, userAcc).send({\n          from: currUserAdd\n        });\n      } catch (err) {\n        console.log(err.msg);\n      }\n\n      this.setState({\n        loading: false\n      });\n      Router.pushRoute(\"/\");\n    });\n\n    _defineProperty(this, \"renderProjcards\", () => {\n      const projCards = this.state.projects.map((proj, index) => {\n        const acc = this.state.userAddress;\n        return {\n          key: index,\n          header: __jsx(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 88\n            },\n            __self: this\n          }, __jsx(Link, {\n            route: `/projects/${acc}/${proj[0]}`,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 89\n            },\n            __self: this\n          }, __jsx(\"a\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 90\n            },\n            __self: this\n          }, __jsx(\"h4\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 91\n            },\n            __self: this\n          }, proj[1])))),\n          description: __jsx(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 97\n            },\n            __self: this\n          }, __jsx(\"p\", {\n            style: {\n              whiteSpace: \"nowrap\",\n              overflow: \"hidden\",\n              textOverflow: \"ellipsis\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 98\n            },\n            __self: this\n          }, proj[3])),\n          extra: __jsx(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 110\n            },\n            __self: this\n          }, __jsx(\"p\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 111\n            },\n            __self: this\n          }, proj[2]))\n        };\n      });\n      this.setState({\n        projCards: projCards\n      });\n    });\n  }\n\n  static async getInitialProps(props) {\n    return {\n      userIndex: props.query.index\n    };\n  }\n\n  async componentDidMount() {\n    const userIndex = this.props.userIndex;\n    const userDetails = await projhub.methods.users(userIndex).call();\n    let currUserAdd = await web3.eth.getAccounts();\n    currUserAdd = currUserAdd[0];\n    let currUserId = await projhub.methods.getUserDetails(currUserAdd).call();\n    currUserId = currUserId[0];\n    let isFollower = await projhub.methods.isFollower(currUserId, userDetails[1]).call();\n    isFollower = isFollower || currUserId == userIndex;\n    console.log(isFollower);\n    let projects = [];\n\n    for (let i = 0; i < userDetails[4]; i++) {\n      const proj = await projhub.methods.getProjectDetails(userDetails[1], i).call();\n      projects.push(proj);\n    }\n\n    this.setState({\n      userIndex: userIndex,\n      userAddress: userDetails[1],\n      userName: userDetails[2],\n      userEmail: userDetails[3],\n      userProjCount: userDetails[4],\n      projects: projects,\n      currUserAdd: currUserAdd,\n      currUserId: currUserId,\n      isFollower: isFollower\n    });\n    console.log(projects);\n    this.renderProjcards();\n  }\n\n  render() {\n    return __jsx(Layout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, __jsx(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, __jsx(Grid, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, __jsx(Grid.Column, {\n      width: \"5\",\n      style: {\n        marginTop: \"20px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, __jsx(\"h2\", {\n      style: {\n        marginBottom: \"0px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, this.state.userName), __jsx(\"p\", {\n      style: {\n        color: \"grey\",\n        marginTop: \"0px\",\n        fontSize: \"14px\",\n        overflow: \"hidden\",\n        textOverflow: \"ellipsis\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, this.state.userAddress), __jsx(\"p\", {\n      style: {\n        fontSize: \"15px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, \"Email: \", this.state.userEmail), __jsx(Button, {\n      disabled: this.state.isFollower,\n      loading: this.state.loading,\n      color: \"teal\",\n      content: \"Follow\",\n      onClick: () => this.onFollow(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }))), __jsx(Grid.Column, {\n      width: \"10\",\n      style: {\n        borderLeft: \"1px solid\",\n        borderColor: \"lightgrey\",\n        marginTop: \"20px\",\n        padding: \"10px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, __jsx(Card.Group, {\n      items: this.state.projCards,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    })))));\n  }\n\n}\n\nexport default DisplayUser;","map":{"version":3,"sources":["/home/hrishib/Desktop/gitchain/pages/users/display/index.js"],"names":["React","Component","Layout","projhub","web3","ipfs","Grid","Container","Card","Button","Router","Link","DisplayUser","userIndex","userName","userAddress","userEmail","userProjCount","projects","projCards","loading","currUserAdd","currUserId","isFollower","setState","userAcc","state","console","log","methods","followUser","send","from","err","msg","pushRoute","map","proj","index","acc","key","header","description","whiteSpace","overflow","textOverflow","extra","getInitialProps","props","query","componentDidMount","userDetails","users","call","eth","getAccounts","getUserDetails","i","getProjectDetails","push","renderProjcards","render","marginTop","marginBottom","color","fontSize","onFollow","borderLeft","borderColor","padding"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Layout from \"../../../components/Layout\";\nimport projhub from \"../../../ethereum/projhub\";\nimport web3 from \"../../../ethereum/web3\";\nimport ipfs from \"../../../ethereum/ipfs\";\nimport { Grid, Container, Card, Button } from \"semantic-ui-react\";\nimport { Router, Link } from \"../../../routes\";\n\nclass DisplayUser extends Component {\n  state = {\n    userIndex: 0,\n    userName: \"\",\n    userAddress: \"\",\n    userEmail: \"\",\n    userProjCount: 0,\n    projects: [],\n    projCards: [],\n    loading: false,\n    currUserAdd: \"\",\n    currUserId: \"\",\n    isFollower: true\n  };\n\n  static async getInitialProps(props) {\n    return {\n      userIndex: props.query.index\n    };\n  }\n\n  async componentDidMount() {\n    const userIndex = this.props.userIndex;\n    const userDetails = await projhub.methods.users(userIndex).call();\n    let currUserAdd = await web3.eth.getAccounts();\n    currUserAdd = currUserAdd[0];\n    let currUserId = await projhub.methods.getUserDetails(currUserAdd).call();\n    currUserId = currUserId[0];\n    let isFollower = await projhub.methods.isFollower(currUserId, userDetails[1]).call();\n    isFollower = isFollower || (currUserId==userIndex);\n    console.log(isFollower);\n\n    let projects = [];\n    for (let i = 0; i < userDetails[4]; i++) {\n      const proj = await projhub.methods\n        .getProjectDetails(userDetails[1], i)\n        .call();\n      projects.push(proj);\n    }\n\n    this.setState({\n      userIndex: userIndex,\n      userAddress: userDetails[1],\n      userName: userDetails[2],\n      userEmail: userDetails[3],\n      userProjCount: userDetails[4],\n      projects: projects,\n      currUserAdd: currUserAdd,\n      currUserId: currUserId,\n      isFollower: isFollower\n    });\n    console.log(projects);\n    this.renderProjcards();\n  }\n\n  onFollow = async () => {\n    this.setState({ loading: true });\n    const userAcc = this.state.userAddress;\n    const currUserAdd = this.state.currUserAdd;\n    const currUserId = this.state.currUserId;\n    console.log(currUserAdd, currUserId);\n    try {\n      await projhub.methods\n        .followUser(currUserId, userAcc)\n        .send({ from: currUserAdd });\n    }\n    catch (err) {\n      console.log(err.msg);\n    }\n    this.setState({ loading: false });\n    Router.pushRoute(\"/\");\n  }\n\n  renderProjcards = () => {\n    const projCards = this.state.projects.map((proj, index) => {\n      const acc = this.state.userAddress;\n      return {\n        key: index,\n        header: (\n          <div>\n            <Link route={`/projects/${acc}/${proj[0]}`}>\n              <a>\n                <h4>{proj[1]}</h4>\n              </a>\n            </Link>\n          </div>\n        ),\n        description: (\n          <div>\n            <p\n              style={{\n                whiteSpace: \"nowrap\",\n                overflow: \"hidden\",\n                textOverflow: \"ellipsis\"\n              }}\n            >\n              {proj[3]}\n            </p>\n          </div>\n        ),\n        extra: (\n          <div>\n            <p>{proj[2]}</p>\n          </div>\n        )\n      };\n    });\n    this.setState({ projCards: projCards });\n  };\n\n  render() {\n    return (\n      <Layout>\n        <Container>\n          <Grid>\n            <Grid.Column width=\"5\" style={{ marginTop: \"20px\" }}>\n              <div>\n                <h2 style={{ marginBottom: \"0px\" }}>{this.state.userName}</h2>\n                <p\n                  style={{\n                    color: \"grey\",\n                    marginTop: \"0px\",\n                    fontSize: \"14px\",\n                    overflow: \"hidden\",\n                    textOverflow: \"ellipsis\"\n                  }}\n                >\n                  {this.state.userAddress}\n                </p>\n                <p style={{ fontSize: \"15px\" }}>\n                  Email: {this.state.userEmail}\n                </p>\n                <Button disabled={this.state.isFollower} loading={this.state.loading} color=\"teal\" content=\"Follow\" onClick={() => this.onFollow()}/>\n              </div>\n            </Grid.Column>\n            <Grid.Column\n              width=\"10\"\n              style={{\n                borderLeft: \"1px solid\",\n                borderColor: \"lightgrey\",\n                marginTop: \"20px\",\n                padding: \"10px\"\n              }}\n            >\n              <Card.Group items={this.state.projCards} />\n            </Grid.Column>\n          </Grid>\n        </Container>\n      </Layout>\n    );\n  }\n}\n\nexport default DisplayUser;\n"]},"metadata":{},"sourceType":"module"}